# 프로젝트: SMP 기반 발전소 수익 분석 대시보드 개발

## 1. 개요
- 발전소의 시간별 SMP(계통한계가격) 변화에 따른 수익(공헌이익)을 시뮬레이션하는 '단일 페이지 웹 애플리케이션'을 만들어줘.
- **Tech Stack:** Next.js (App Router), React, TypeScript, Tailwind CSS, Shadcn UI, Recharts (차트/그리드 필요 시)
- **Design Tone:** 기술적이고 직관적인 대시보드 (산업용 UI 느낌, 폰트는 가독성 좋은 산세리프)

## 2. 화면 레이아웃 요구사항
화면을 크게 3단으로 구성해줘.

### A. 상단 (입력 및 시뮬레이션 제어)
- **주요 입력값 (Input Fields):** 사용자가 수정 가능한 노란색 배경의 Input Box들.
  1. 기준 SMP (Default: 150 원/kWh)
  2. PKS 단위열량 (Default: 4,000 kcal/kg)
  3. WC 단위열량 (Default: 3,750 kcal/kg)
  4. PKS 단위가격 (Default: 223,000 원/톤)
  5. WC 단위가격 (Default: 49,000 원/톤)
- **감발 임계값 설정 (노란색 배경):** 감발 운전 조건을 설정하는 입력 필드들.
  1. 80MW 감발 임계값 (Default: 92 원/kWh 이하)
  2. 65MW 감발 임계값 (Default: 79 원/kWh 이하)
  3. 정지 임계값 (Default: 32 원/kWh 이하, 미운영: 기동요금)
- **결과 요약 카드:** 현재 기준 SMP 입력 시, 93MW/80MW/65MW 운전 시의 '시간당 기대 수익(만원)' 비교 표시.
  - 93MW: 정상 운전 중 (기준 SMP가 감발 임계값보다 높을 때)
  - 80MW: 기준 SMP가 80MW 감발 임계값 이하일 때의 시간당 수익
  - 65MW: 기준 SMP가 65MW 감발 임계값 이하일 때의 시간당 수익

### B. 중단 (메인 분석 테이블)
- 3개의 행(Row)을 가진 테이블: [93MW(정상), 80MW(감발1), 65MW(감발2)]
- 각 행은 사용자가 입력한 '기준 SMP'와 아래의 '계산 공식'에 따라 실시간으로 모든 수치가 변해야 함.
- **사용자 입력 컬럼 (노란색 배경):**
  - 송전효율 (각각 30.40%, 30.23%, 29.35%)
  - 소내소비율 (각각 8.4%, 8.7%, 10.5%)

### C. 하단 (시간대별 스케줄링 및 감발 분석)
- **좌측: 날짜별 시간대별 SMP 입력 테이블**
  - 날짜 추가/삭제 기능 (기본값: 최근 3일)
  - 각 날짜별로 24시간(1~24시) SMP를 입력할 수 있는 그리드
  - 각 셀은 노란색 배경으로 입력 가능
  - 특정 시간대의 SMP가 감발 임계값 이하일 경우 시각적 강조 (예: 빨간색 테두리 또는 배경)
  
- **우측: 감발 요약 계산기**
  - 날짜별 감발 분석 결과를 표시하는 테이블
  - 컬럼: 날짜, 감발 평균 SMP, 감발시간, 시간당 수익, 총 금액
  - 각 날짜별로 자동 계산:
    - **감발 평균 SMP**: 해당 날짜의 감발 시간대(임계값 이하)의 SMP 평균값
    - **감발시간**: 감발 조건에 해당하는 시간대의 개수 (시간)
    - **시간당 수익**: 감발 평균 SMP 기준으로 계산된 시간당 수익 (만원)
    - **총 금액**: 감발시간 × 시간당 수익 (만원)
  - 최하단에 전체 합계 행 표시 (계)

## 3. 핵심 계산 공식 (Business Logic) **중요**
아래 변수명과 공식을 자바스크립트 함수로 정확히 구현해줘. 모든 계산은 Row(출력 93/80/65)별로 각각 수행됨.

**[고정 상수]**
- WC 연료사용량 = 700 (톤/일)
- REC 가격 = 63 (원)
- 상수 860 (kcal/kWh 변환 계수)

**[계산 순서 및 공식]**
1. **송전량(MWh)** = 출력 * (1 - 소내소비율) * 24
   *(참고: 공식에는 24가 없었으나, 일일 사용량을 구하는 문맥상 송전량 자체는 시간당 값일 수 있음. 단, 아래 매출 계산에서 24를 곱하므로 여기서는 '시간당 송전량'으로 정의하고 진행할 것: `출력 * (1 - 소내소비율)`)*
2. **발전효율(%)** = 송전효율 / (1 - 소내소비율)
3. **PKS 연료사용량(톤/일)** = (출력 / 발전효율 * 860 * 24 - (700 * WC단위열량)) / PKS단위열량
   *(주의: WC연료사용량 700은 고정값)*
4. **WC 혼소율(%)** = (700 * WC단위열량) / (PKS연료사용량 * PKS단위열량 + 700 * WC단위열량)
5. **PKS 발전단가(원/kWh)** = PKS단위가격 / PKS단위열량 * 860 / 송전효율 / 1000
6. **WC 발전단가(원/kWh)** = WC단위가격 / WC단위열량 * 860 / 송전효율 / 1000
7. **약품비(원/kWh)**
   - IF (출력 == 93) THEN 7.6
   - ELSE (현재출력 / 93) * 7.6 * 0.95  *(로직: 이전 행 참조 대신 기준값 93 활용)*
8. **수전요금(원/kWh)** = 1,158,000 / (송전량[시간당] * 24 * 316)
   *(365-49 = 316 적용)*
9. **매출_전력(백만원)** = (SMP * 출력 * (1 - 소내소비율) / 1000 * 24) / 1000000
10. **매출_REC(백만원)** = (63 * 출력 * (1 - 소내소비율) / 1000 * 24) / 1000000
11. **매출_계(백만원)** = 매출_전력 + 매출_REC
12. **비용_연료비(백만원)** = (PKS연료사용량 * PKS단위가격 + 700 * WC단위가격) / 1000000
13. **비용_약품비(백만원)** = (출력 * (1 - 소내소비율) * 약품비단가 / 1000 * 24) / 1000000
14. **비용_수전료(백만원)** = (출력 * (1 - 소내소비율) * 수전요금단가 / 1000 * 24) / 1000000
15. **공헌이익(백만원/일)** = 매출_계 - (비용_연료비 + 비용_약품비 + 비용_수전료)

**[감발 분석 계산 공식]**
16. **시간당 기대수익(만원)** = 공헌이익(백만원/일) / 24 * 10
   *(백만원을 만원으로 변환: × 10, 일일 값을 시간당으로 변환: ÷ 24)*
   
17. **감발 시간 판정 로직:**
   - 각 시간대별 SMP 값을 감발 임계값과 비교
   - IF (SMP ≤ 80MW 감발 임계값 AND SMP > 65MW 감발 임계값) THEN 감발시간 카운트 (80MW 운전)
   - IF (SMP ≤ 65MW 감발 임계값 AND SMP > 정지 임계값) THEN 감발시간 카운트 (65MW 운전)
   - IF (SMP ≤ 정지 임계값) THEN 감발시간 카운트 (정지, 기동요금 고려)
   
18. **감발 평균 SMP(원/kWh)** = SUM(감발 시간대의 SMP 값) / 감발 시간대 개수
   *(감발 조건에 해당하는 시간대의 SMP 값들의 평균)*
   
19. **감발 시간당 수익(만원)** = 감발 평균 SMP를 기준 SMP로 사용하여 해당 출력(80MW 또는 65MW)의 시간당 기대수익 계산
   *(감발 평균 SMP가 80MW 임계값 이하이면 80MW 기준, 65MW 임계값 이하이면 65MW 기준으로 계산)*
   
20. **감발 총 금액(만원)** = 감발시간 × 감발 시간당 수익

## 4. 시각화 및 UX 요청
- **입력 필드 구분:** 사용자가 입력 가능한 변수(SMP, 효율, 단가 등)는 노란색 배경(`bg-yellow-100`)으로 처리하고, 계산된 값은 흰색이나 회색 배경으로 처리해서 구분해줘.
- **단위 표시:** 
  - 금액은 '백만원' 단위로 소수점 1자리까지 표시
  - 시간당 수익은 '만원' 단위로 정수 또는 소수점 1자리까지 표시
  - 단가는 '원' 단위로 정수 혹은 소수점 1자리까지 표시
  - 효율은 '%' 단위로 소수점 2자리까지 표시
- **반응성:** 
  - 기준 SMP나 연료 단가를 수정하면 즉시 공헌이익 테이블이 재계산되어야 함
  - 시간대별 SMP 값을 수정하면 감발 요약 테이블이 실시간으로 업데이트되어야 함
  - 감발 임계값을 수정하면 감발 시간 판정과 요약 계산이 즉시 반영되어야 함
- **시각적 피드백:**
  - 감발 조건에 해당하는 시간대는 시각적으로 강조 (예: 빨간색 테두리 또는 연한 빨간색 배경)
  - 공헌이익이 양수인 경우 녹색 강조, 음수인 경우 빨간색 강조
  - 감발 요약 테이블의 중요 수치(감발시간, 총 금액 등)는 노란색 배경으로 강조 가능

## 5. 추가 기능 요구사항
- **날짜 관리:** 날짜 추가/삭제 버튼을 통해 여러 날짜의 데이터를 관리할 수 있어야 함
- **데이터 내보내기/가져오기:** 분석 결과를 CSV 또는 Excel 형식으로 내보내기 및 가져오기 기능 (선택사항)
- **차트 시각화:** 시간대별 SMP 변화를 라인 차트로 표시하여 시각적으로 파악 가능하도록 (선택사항)

## 6. 구현 완료 기능

### 6.1 시간대별 SMP 가격 변동 추이 카드
- **위치:** 시뮬레이션 탭 하단에 추가됨
- **기능:**
  - 날짜별 24시간 SMP 가격을 표 형태로 표시
  - 가로 스크롤 없이 24시간 모두 표시 (날짜 열: 70px, 시간 열: 각 36px)
  - 헤더: "날짜/시간" + 1~24 시간
  - 헤더 배경색: 연한 하늘색 (#E0F2F7)
  - 테이블 스타일: Material Design 가이드라인 준수

### 6.2 날짜 표시 기능
- **날짜 형식:** "MM/DD(요일)" 형식으로 표시
- **요일별 색상 구분:**
  - 토요일: 파란색 글씨 (text-primary-600)
  - 일요일: 빨간색 글씨 (text-[#D32F2F])
  - 평일: 기본 색상 (검정)

### 6.3 감발 기준 SMP 가격 설정
- **설정 버튼:** 카드 헤더 우측에 아이콘 버튼 (Settings 아이콘)
- **기능:**
  - 설정 버튼 클릭 시 다이얼로그 열림
  - 감발 기준 SMP 가격 입력 (기본값: 80 원/kWh)
  - 입력한 값 이하의 가격 셀은 빨간색 배경 (#fcb1b1)으로 표시
  - 실시간으로 테이블에 반영

### 6.4 데이터 구조
- **타입 정의:**
  - `DailySMPData`: 날짜별 24시간 SMP 가격 데이터
  - `HourlySMPData`: 전체 시간대별 SMP 데이터 구조
- **기본 데이터:** 3일간의 샘플 데이터 포함 (2024-12-13, 2024-12-14, 2024-12-15)

### 6.5 상태 관리
- **AppState 확장:** `hourlySMPData` 필드 추가
- **로컬 스토리지:** 상태 자동 저장/복원 지원
- **기존 상태 호환성:** 기존 상태에 hourlySMPData가 없으면 기본값으로 병합

## 7. 기술 스택 및 구현 세부사항

### 7.1 컴포넌트 구조
- **SMPPriceTable.tsx:** 시간대별 SMP 가격 변동 추이 카드 컴포넌트
- **Simulation.tsx:** 시뮬레이션 탭 메인 컴포넌트 (SMPPriceTable 통합)

### 7.2 스타일링
- **디자인 시스템:** Material Design + Fluent Design Hybrid
- **테이블 스타일:**
  - 폰트 크기: 10px
  - 셀 패딩: px-1, py-1.5
  - 테두리: border-r border-material-gray-200
  - 호버 효과: hover:bg-material-gray-50/50

### 7.3 사용자 인터페이스
- **설정 다이얼로그:**
  - Material Design 스타일 다이얼로그
  - 노란색 배경 입력 필드 (#FFF9E6)
  - 취소/저장 버튼
- **시각적 피드백:**
  - 감발 기준 이하 가격: 빨간색 배경 (#fcb1b1)
  - 주말 날짜: 색상 구분 (토요일 파란색, 일요일 빨간색)

## 8. 향후 개선 사항
- 날짜 추가/삭제 기능
- 시간대별 SMP 가격 수정 기능
- 감발 요약 계산기 (우측 패널)
- 데이터 내보내기/가져오기 기능
- 차트 시각화 기능